#!/usr/bin/env bash
# environment shared by entire project

# Path to this script
script_path="$(dirname "$(realpath "${BASH_SOURCE[0]}")")"



# Path to the repo is two directories up
export REPO_HOME="${script_path%/*/*}/"

# script name and path relative to the top of the project
script_fn(){
  echo "$(basename ${BASH_SOURCE[0]})"
}
script_fp(){
  echo "$(realpath --relative-to="$REPO_HOME" "$script_path")/$(script_fn)"
}
export -f script_fn script_fp

# REPO_HOME relative file path to this script
# Calling the function correctly without braces
export ENV=$(script_fp)

# this script must be sourced, sort of like Python activate
if [[ "${BASH_SOURCE[0]}" == "$0" ]]; then
  echo "$ENV must be sourced, not executed. Exiting."
  exit 1
fi

export PROJECT=$(basename "$REPO_HOME")

# Third party tool(s) that the project admin kindly installed.
# The developer and tester should use these links to find them.
export JAVA_HOME="$REPO_HOME/tool_shared/third_party/jdk-11"

# set the shell prompt to show the project
PPS1="\n[$PROJECT]\n\u@\hยง$(pwd)ยง\n> "
PPS2=">> "

echo ENV "$ENV"
echo REPO_HOME "$REPO_HOME"
echo PROJECT "$PROJECT"
echo "$ENV completed."


